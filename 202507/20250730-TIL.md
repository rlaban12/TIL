# 2025 07 30 수업 정리
# java jpa
## 1. 고아 객체(Orphan Removal)와 CascadeType.REMOVE
### - 고아 객체(Orphan Object)란 부모 객체에 속하지 않는 자식 객체를 의미한다.
### - CascadeType.REMOVE는 부모 엔티티가 삭제될 때 연관된 자식 엔티티도 함께 삭제하는 옵션이다.
### - 잘 이해가 안되면 @OneToMany(mappedBy = "department", cascade = CascadeType.ALL, orphanRemoval = true) 외우고 쓰면 된다.
## 2. N+1 문제 및 Fetch Join
### - N + 1 문제
#### 1) sql에서는 sql문을 중복되도 한번만 작성할 것을 jpa는 sql은 중복없게 sql문을 여러번 쓰는 문제이다.
### - Fetch join
#### 1) N + 1문제를 해결하기 위해서 sql 문법에 없는 jpa의 문법이다.
#### 2) Fetch Join은 JPQL(JPA Query Language)의 JOIN FETCH 구문을 사용하여 수행된다.
#### 3) N + 1 문제 해결을 위한 fetch join 사용 예시
#### -> @Query("SELECT d FROM Department  d JOIN FETCH d.employees")
#### -> List<Department> findAllByFetch();
### - 다 대 다 관계
#### 1) N : M
#### 2) 다대다 관계는 이 관계를 1대 다와 다대 1로 풀어줄 중간테이블이 필요하다.

# sql
## 1. FROM절의 서브쿼리: 인라인 뷰 (Inline View)
### - 인라인 뷰(Inline View)는 FROM 절에 사용되는 서브쿼리를 말한다.
## 2. SELECT절의 서브쿼리: 스칼라 서브쿼리 (Scalar Subquery)
### - 스칼라 서브 쿼리 == 연관 서브쿼리
### - 연관서브쿼리: 서브쿼리가 한번 실행되고 끝나는게 아니라 바깥쪽 메인쿼리 한 행을 실행할 때마다 반복 실행한다.
## 3. 서브쿼리의 두 얼굴: 비연관 vs 연관
### - 비연관
#### 1) 바깥 쿼리와 아무런 관계없이, 독립적으로 딱 한 번만 실행되어 그 결과를 메인 쿼리에 전달해주는 방식이다.
### - 연관
#### 1) 바깥 쿼리의 한 행, 한 행이 처리될 때마다 그 행의 값을 참조하여 다시 실행되는 서브쿼리이다.
#### 2) 바깥 쿼리와 아주 긴밀한 '관계'를 맺고 있다.



